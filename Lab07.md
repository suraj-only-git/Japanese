
 
# 目次

- 概要	

- Power BI	

    タスク 1: レポートを自動作成する	

    タスク 2: 既定の (メトリック) テーブルを非表示にする

    タスク 3: 新しいレポートの背景を構成する	

    タスク 4: レポートにヘッダーを追加する	

    タスク 5: レポートに KPI を追加する	

    タスク 6: レポートに折れ線グラフを追加する	

    タスク 7: Date テーブルの Year 列を構成する	

    タスク 8: Date テーブルの Short_Month_Name 列を構成する	

    タスク 9: 折れ線グラフを書式設定する	

    タスク 10: 新しいデータを追加して Direct Lake モードをシミュレートする	

- ラボ環境をクリーンアップする	

- リファレンス	


# 概要

さまざまなデータ ソースから Lakehouse にデータを取り込み、Lakehouse について学び、データ モデルを作成し、データ ソースの更新スケジュールを設定しました。次は、レポートを作成します。

このラボを終了すると、次のことが学べます。

- レポートを自動的に作成する方法
- 空のキャンバスからレポートを構築する方法
- データが自動的に更新される Direct Lake モードを体験する方法

# Power BI

## タスク 1: レポートを自動作成する

まず、レポートの自動作成オプションを使用してみましょう。ラボの後半では、Power BI にあるレポートを作成し直します。


1. 前のラボで作成した **Fabric ワークスペース**に移動します。

2. おそらく Data Factory のホーム ページが表示されます。左側のパネルの下部にある **Data Factory アイコン**を選択します。

3. Fabric エクスペリエンスのダイアログが開きます。**Power BI** を選択します。**Power BI ホーム ページ**が表示されます。
 
4. 上部のメニューから**新しいレポート**を選択します。
 
5. **最初のレポートの作成画面**が表示されます。データを手動で入力してレポートを作成することも、公開されているセマンティック モデルを選択することもできます。前のラボではセマンティック モデルを作成しました。それを使ってみましょう。**公開されたセマンティック モデルを選択**オプションを選択します。
 
6. [レポートで使用するデータセットを選択] ページが開きます。4 つのオプションがあります。**lh_FAIAD を選択します**。

a. **lh_FAIAD**: これは、作成したデータセットを含む lakehouse です。これをレポートに使用します。

b. **Units by Supplier**: これは T-SQL を使用して作成したデータセットです。

c. **DataflowsStagingWarehouse**: これは既定で作成されるステージング用のウェアハウスですが、データをステージングしなかったため使用していません。

d. **DataflowsStagingLakehouse**: これは既定で作成されるステージング用の lakehouse ですが、データをステージングしなかったため使用していません。

7. **レポートの自動作成ボタンの横の矢印**をクリックします。[レポートの自動作成] と [空のレポートの作成] という 2 つのオプションがあることに注意してください。自動作成を試してみましょう。**レポートの自動作成**を選択します。

 
8. Power BI によって、レポートの自動作成が開始されます。[データの事前選択] オプションを選択することもできます。レポートの準備が完了すると、画面の右上にダイアログが表示されます。**レポートを今すぐ表示**を選択します。
 
**チェックポイント**: 以下のスクリーンショットのようなレポートが表示されます。少数の KPI といくつかの傾向のビジュアルがあります。新しいモデルを分析しようとしており、すぐに開始する必要がある場合、これは良いスタート地点となります。

**注**: 上部のメニューには、レポートを編集したり、データをテーブルとして表示したりするオプションがあります。自由にこれらのオプションを試してみてください。

9. 準備ができたら、右側の**データ** セクションのすべてのテーブルを**折りたたみ**ます。作成したモデルに含まれていない新しいテーブルが 5 つあることに注意してください。これらは、パフォーマンスの分析に役立つように追加される既定のテーブルです。これらは間もなくレポート ビューから削除される予定です。

10. このレポートを保存しましょう。上部のメニューで**保存**を選択します。

11. [レポートの保存] ダイアログが開きます。レポートに **rpt_Sales_Auto_Report** という名前を付けます。

**注**: レポート名の前に report の省略形である rpt を付けています。

12. レポートが **<ワークスペース名>** に保存されたことを確認します。

13. **保存**を選択します。
 

## タスク 2: 既定の (メトリック) テーブルを非表示にする

Power BI Desktop で使用しているのと同じようなレポートを作成しましょう。ここでは空のキャンバスから開始します。レポートの作成を開始する前に、レポート ビューから既定のテーブル (上のスクリーンショット) を削除しましょう。これは、Lakehouse のモデリング セクションで行います。

1. 左側のパネルの下部にある **Power BI アイコン**を選択します。Fabric のダイアログが開きます。

2. **Data Engineering** を選択します。Data Engineering のホーム ページが表示されます。
 
3. **クイック アクセス** セクションまで下にスクロールします。

4. **lh_FAIAD -> SQL 分析エンドポイント**を選択します。Lakehouse の [データ] ビューが表示されます。

5. **左側のパネルの下部で、モデル**を選択し、[モデル] ビューに移動します。

デザイン キャンバスには既定のテーブルがあります。(場合によっては、それらを表示するために右または下にスクロールする必要があります)
 
6. テーブル **long_running_queries** を右クリックし、**レポート ビューの非表示**を選択します。

7. 同様に、以下のテーブルでも**レポート ビューの非表示**を選択します。

    a. fabric_query_starting

    b. fabric_query_completed

    c. exec_requests_history

    d. frequently_run_queries


## タスク 3: 新しいレポートの背景を構成する

1. [モデル] ビューから新しいレポートの作成を開始できます。上部のメニューから、**ホーム -> 新しいレポート**を選択します。ブラウザーの新しいウィンドウ/タブに Power BI レポート キャンバスが表示されます。
 
2. まだ開いていない場合は、お使いのラボ環境の**デスクトップの Report** フォルダーにある **FAIAD.pbix** を開きます。

このレポートを参考として使用します。まず最初にキャンバスの背景を追加します。レポート ヘッダーを作成し、いくつかの KPI を追加して、売上推移の折れ線グラフを作成します。時間の都合上、また出席者には Power BI Desktop でのビジュアル作成の経験があることをふまえ、すべてのビジュアルの作成は行いません。
 
3. ブラウザーで **Power BI キャンバス**に戻ります。

4. [視覚化] ペインで**ページの書式設定アイコン**を選択します。

5. **キャンバスの背景セクション**を展開します。

6. **イメージ** オプションの**参照**を選択します。エクスプローラー ダイアログが開きます。

7. ラボ環境の**デスクトップの Report** フォルダーに移動します。

8. **Summary Background.png** を選択します。

9. **イメージのサイズ調整**ドロップダウンを**自動調整**に設定します。

10. [透過性] を **0%** に設定します。
 

## タスク 4: レポートにヘッダーを追加する

1. 上部の余白にヘッダーを追加しましょう。**メニューで、テキスト ボックス**を選択し
ます。

2. テキスト ボックスの最初の行として **Fabrikam Company** と入力します。

3. テキスト ボックスの 2 行目として **Sales Report** と入力します。

4. **Fabrikam Company** を強調表示し、**フォント**を **Segoe UI**、**フォント サイズ**を **18**、**太字**に設定します。

5. **Sales Report** を強調表示し、**フォント**を **Segoe UI**、**フォント サイズ**を **14**、**太字**に設定します。

6. **テキスト ボックスを選択**した状態で、右側の [書式] ペインで**効果を展開**します。

7. **背景**スライダーを使用して、**オフ**に設定します。

8. **上部の余白に収まるようにテキスト ボックス**のサイズを変更します。
 
## タスク 5: レポートに KPI を追加する

1. Sales KPI を追加しましょう。キャンバス内で**空白**を選択し、テキスト ボックスからフォーカスを外します。

2. **視覚化セクション**で、**複数行カード ビジュアル**を選択します。

3. **データ セクション**で、**Sales テーブル**を展開します。

4. **Sales メジャー**を選択します。
 
5. **複数行カード ビジュアルを選択**した状態で、[視覚化] セクションの**ビジュアルの書式設定アイコン**を選択します。

6. **カテゴリ ラベル** セクションを展開します。

7. **フォント サイズ**を **14** に上げます。

8. **色ドロップダウン**を選択します。[カラー パレット] ダイアログが開きます。

9. [16 進数] の値を **#004753** に設定します。
 
10. **カード** セクションを展開します。

11. **アクセント バー** スライダーを使用して、**オフ**に設定します。
 
12. [視覚化] ペインで**全般**を選択します。

13. **効果セクション**を展開します。

14. **背景**スライダーを使用して、**オフ**に設定します。

15. **ビジュアル**のサイズを変更して、**スクリーンショットに表示されている左のボックス**に移動します。
 
 
16. 別の KPI を追加してみましょう。先ほど作成した **Sales 複数行カード**を選択します。キーボードの **Ctrl+C** を使用して、ビジュアルを**コピー**します。

17. キーボードの **Ctrl+V** を使用して、ビジュアルを**貼り付け**ます。ビジュアルがキャンバスに貼り付けられました。

18. **新しいビジュアルを強調表示**した状態で、**視覚化ペイン -> ビジュアルのビルド -> フィールド** セクションから Sales メジャーを削除します。

19. **Data** セクションで、**Sales** テーブルを展開し、**Units** メジャーを選択します。

20. **ビジュアル**のサイズを変更し、**Sales ビジュアルの下のボックスに配置**します。
 

## タスク 6: レポートに折れ線グラフを追加する

折れ線グラフを作成して、リセラー会社ごとの売上の推移を視覚化しましょう。

1. キャンバス内で**空白**を選択し、複数行カード ビジュアルからフォーカスを外します。

2. **視覚化セクション**で、**折れ線グラフ**を選択します。

3. **データ セクション**で **Date** テーブルを展開します。

4. **Year** フィールドを選択します。Year は既定で合計され、Y 軸に追加されることに注意してください。これを修正しましょう。
 

## タスク 7: Date テーブルの Year 列を構成する

1. **Lakehouse のモデル ビュー**が表示されているブラウザーのタブに移動します。

2. 左側の [エクスプローラー] ペインで、**lhFAIAD -> Schemas -> dbo -> Tables -> Date** を展開します。

3. **Year** 列を選択します。

4. 右側の**プロパティ** ペインで、**詳細**セクションを展開します。

5. **集計の方法**ドロップダウン リストで、**なし**を選択します。
 
6. **Power BI キャンバス**が表示されているブラウザーのタブに戻ります。

7. 上部のメニューで、**更新**を選択します。[Year] は集計フィールドではなくなりました。

8. **折れ線グラフ ビジュアルを選択**した状態で、Y 軸から **Year の合計を削除**します。

9. **Year** フィールドを選択すると、**X 軸**に追加されます。

10. **Sales** テーブルを展開し、**Sales メジャー** を選択します。
 

## タスク 8: Date テーブルの Short_Month_Name 列を構成する

1. このグラフに月を追加してみましょう。Date テーブルの Short_Month_Name フィールドを X 軸の Year の下にドラッグします。ビジュアルが Sales の順に並べ替えられていることに注目してください。Short_Month_Name の順に並べ替えてみましょう。

2. ビジュアルの右上隅にある省略記号 (…) を選択します。

3. 軸の並べ替え -> Year Short_Month_Name を選択します。

4. ビジュアルの右上隅にある省略記号 (…) を選択します。

5. 軸の並べ替え -> 昇順で並べ替えを選択します。
 
**注**: 月がアルファベット順に並べられています。これを修正しましょう。
 
6. Lakehouse のモデル ビューが表示されているブラウザーのタブに移動します。

7. 左側の [エクスプローラー] ペインで、lhFAIAD -> Schemas -> dbo -> Tables -> Date を展開します。

8. Short_Month_Name 列を選択します。

9. 右側のプロパティ ペインで、詳細セクションを展開します。

10. 列で並べ替えドロップダウンで Month を選択します。
 
11. Power BI キャンバスが表示されているブラウザーのタブに戻ります。

12. 上部のメニューで、更新を選択します。月が正しく並べ替えられました。
  

タスク 9: 折れ線グラフを書式設定する
レポートの作成中にセマンティック モデルを更新することがいかに簡単であるかに注目してください。これにより Power BI Desktop のようなシームレスな対話型操作が実現します。
1. 	折れ線グラフ ビジュアルを選択した状態で、データ セクションの Reseller テーブルを展開します。
2. 	Reseller -> Reseller Company フィールドを凡例セクションにドラッグします。
 
3. 	折れ線グラフ ビジュアルを選択した状態で、視覚化セクションで ビジュアルの書式設定アイコン -> 全般を選択します。
4. 	タイトル セクションを展開します。
5. 	タイトルのテキストとして Sales over time を設定します。
6. 	効果セクションを展開します。
7. 	背景スライダーを使用して、オフに設定します。
 
8. 	視覚化セクションでビジュアルの書式設定アイコン -> ビジュアルを選択します。
9. 	X 軸セクションを展開します。
10. 	タイトル スライダーを使用して、オフに設定します。
11. 	罫線セクションを展開します。
12. 	色セクションを展開します。
13. 	Wingtip Toys の色を #004753 に設定します。
14. 	Tailspin Toys の色を #F17925 に設定します。
15. 	ビジュアルのサイズを変更して、スクリーンショットに表示されている右上のボックスに移動します。
16. 	ビジュアルの右までスクロールして、2023 年 4 月までのデータがあることを確認します。
 
17. 	レポートを保存しましょう。メニューでファイル -> 保存を選択します。
18. 	[レポートの保存] ダイアログが開きます。レポートに rpt_Sales_Report という名前を付けます。
注: レポート名の前に report の省略形である rpt を付けています。
19. 	レポートが <ワークスペース名> に保存されたことを確認します。
20. 	保存を選択します。
 
前にも説明していますが、このラボではすべてのビジュアルを作成するわけではありません。時間があるときに、その他のビジュアルをご自由に作成してください。

タスク 10: 新しいデータを追加して Direct Lake モードをシミュレートする
通常、Import モードでは、ソース内のデータが更新されたら、Power BI モデルを更新する必要があります。その後でレポート内のデータが更新されます。Direct Query モードでは、ソースでデータが更新されると、Power BI レポートで使用できるようになります。ただし、通常、direct query モードは低速です。この問題を解決するために、Microsoft Fabric は Direct Lake モードを導入しました。Direct Lake は、データをレイクから Power BI エンジンに直接読み込んで分析できるようにするための高速パスです。これについて詳しく説明します。
実際のシナリオでは、データはソースで更新されます。ここはトレーニング環境なので、2023 年 5 月のデータを含む parquet ファイルに接続してこれをシミュレートします。
1. 	Lakehouse のモデル ビューが表示されているブラウザーのタブに移動します。
2. 	左側のパネルで <ワークスペース名> を選択します。
3. 	df_Sales_ADFS を選択すると、データフローを編集して新しい Parquet ファイルを追加できるようになります。
 
4. 	まだ開いていない場合は、お使いのラボ環境のデスクトップの Report フォルダーにある FAIAD.pbix を開きます。
5. 	リボンからホーム -> データの変換を選択します。Power Query ウィンドウが開きます。
6. 	左側のパネルの DirectLakeフォルダーの下で MayInvoice クエリを選択します。
7. 	右クリックしてコピーを選択します。
 
8. 	ブラウザーの Dataflow の画面に戻ります。
9. 	Dataflow のペインで、Ctrl+V を押します (現時点では右クリックの貼り付けには対応していません)。
ここで、ADLS Base Folder (2) への参照を削除し、ADLS Base Folder を使用しましょう。
10. 	MayInvoice クエリを選択します。
11. 	右側のパネルの適用したステップで、ソースを選択します。
12. 	数式バーで、#"ADLS Base Folder (2)" を #"ADLS Base Folder" に変更します。
13. 	数式バーの横にあるチェック マークを選択するか、Enter キーを押します。
 
14. 	左側のパネルの [クエリ] セクションで ADLS Base Folder (2) クエリを右クリックし、削除を選択します。
15. 	[クエリの削除] ダイアログが表示されます。削除を選択して確定します。
 
16. 	次に、5 月の請求書データを Invoice テーブルに追加しましょう。[クエリ] セクションで Invoice クエリを選択します。
17. 	リボンで ホーム -> クエリをアペンドするを選択します。
18. 	クエリをアペンドするダイアログが表示されます。アペンドするテーブル ドロップダウンから MayInvoice を選択します。
19. 	OK を選択します。
 
20. 	右下隅の公開を選択して、変更内容を保存して公開します。
 
注: 公開されると、データフローが最新の情報に更新されます。これには数分かかる場合があります。
21. 	Power BI キャンバスが表示されているブラウザーのタブに戻ります。
22. 	上部のメニューで、更新を選択します。折れ線グラフに 2023 年 5 月のデータがあります。また、売上高も増加しています。
 
以前のラボで作成した各データフローがスケジュールに従って更新される際に、データが Lakehouse に取り込まれます。Lakehouse 内のデータ モデルが更新され、レポートが最新の情報に更新されます。各データフローが更新されるときに、データ モデルとレポートを更新する必要はありません。これが Direct Lake の利点です。
問題の内容にリストされている課題をもう一度見てみましょう。
•	各種データ ソースごとに異なる更新時間に対応するには、1 日に少なくとも 3 回はデータセットを更新する必要があります。
Direct Lake を使用してこれを解決しました。個々のデータフローはスケジュールに従って更新されます。データセットとレポートを更新する必要はありません。
•	ソース システムで発生したすべての更新を取得するために毎回完全な更新を行う必要があるため、更新に長い時間がかかります。
これについても Direct Lake を使用して解決しました。個々のデータフローはスケジュールに従って更新されます。データセットとレポートを更新する必要はないため、完全な更新について心配する必要はありません。
•	取得元のデータ ソースでエラーが発生すると、データセットの更新が中断されます。従業員ファイルが時間どおりにアップロードされず、データセットの更新が中断されてしまうことが何度もあります。
データ パイプラインを使用すると、エラー時およびさまざまな間隔で更新を再試行できるようになり、この問題の解決に役立ちます。
•	データ モデルに変更を加えるのに非常に長い時間がかかります。データ サイズが大きくて変換が複雑だと、Power Query によるプレビューの更新に時間がかかるためです。
データフローは効率的で、変更が簡単であることを認識しました。通常、データフローのプレビューは読み込みにそれほど時間がかかりません。
•	社内標準は Mac ですが、Power BI Desktop を使用するには Windows PC が必要です。
Microsoft Fabric は SaaS オファリングです。必要となるのは、サービスにアクセスするためのブラウザーだけです。デスクトップにソフトウェアをインストールする必要はありません。

ラボ環境をクリーンアップする
ラボ環境をクリーンアップする準備ができたら、以下のステップを実行します。
1. 	Power BI キャンバスが表示されているブラウザーのタブに戻ります。このタブを閉じ
ます。
2. 	Lakehouse のモデル ビューが表示されているブラウザーのタブに移動します。
3. 	左側のパネルで <ワークスペース名> を選択し、ホーム ページに移動します。
 
4. 	上部のメニューで [アクセスの管理] の横にある省略記号 (…) を選択し、ワークスペースの設定を選択します。
 
5. 	[ワークスペースの設定] ダイアログが開きます。左側のメニューから、その他を選択します。
6. 	このワークスペースを削除するを選択します。
7. 	ワークスペースを削除するダイアログが開きます。削除を選択します。
これで、ワークスペースとワークスペースに含まれていたすべての項目が削除されます。
 

リファレンス
Fabric Analyst in a Day (FAIAD) では、Microsoft Fabric で使用できる主要な機能の一部をご紹介します。サービスのメニューにあるヘルプ (?) セクションには、いくつかの優れたリソースへのリンクがあります。
 
Microsoft Fabric の次のステップに役立つリソースをいくつか以下に紹介します。
•	ブログ記事で Microsoft Fabric の GA に関するお知らせの全文を確認する
•	ガイド付きツアーを通じて Fabric を探索する
•	Microsoft Fabric の無料試用版にサインアップする
•	Microsoft Fabric の Web サイトにアクセスする
•	Fabric の学習モジュールで新しいスキルを学ぶ
•	Fabric の技術ドキュメントを参照する
•	Fabric 入門編の無料の e-book を読む
•	Fabric コミュニティに参加し、質問の投稿やフィードバックの共有を行い、他のユーザーから学びを得る
より詳しい Fabric エクスペリエンスのお知らせに関するブログを参照してください。
•	Fabric の Data Factory エクスペリエンスに関するブログ 
•	Fabric の Synapse Data Engineering エクスペリエンスに関するブログ 
•	Fabric の Synapse Data Science エクスペリエンスに関するブログ 
•	Fabric の Synapse Data Warehousing エクスペリエンスに関するブログ 
•	Fabric の Synapse Real-Time Analytics エクスペリエンスに関するブログ
•	Power BI のお知らせに関するブログ
•	Fabric の Data Activator エクスペリエンスに関するブログ 
•	Fabric の管理とガバナンスに関するブログ
•	Fabric の OneLake に関するブログ
•	Dataverse と Microsoft Fabric の統合に関するブログ

© 2023 Microsoft Corporation. All rights reserved.
このデモ/ラボを使用すると、次の条件に同意したことになります。
このデモ/ラボで説明するテクノロジまたは機能は、ユーザーのフィードバックを取得し、学習エクスペリエンスを提供するために、Microsoft Corporation によって提供されます。ユーザーは、このようなテクノロジおよび機能を評価し、Microsoft にフィードバックを提供するためにのみデモ/ラボを使用できます。それ以外の目的には使用できません。このデモ/ラボまたはその一部を、変更、コピー、配布、送信、表示、実行、再現、発行、ライセンス、著作物の作成、転送、または販売することはできません。
複製または再頒布のために他のサーバーまたは場所にデモ/ラボ (またはその一部) をコピーまたは複製することは明示的に禁止されています。
このデモ/ラボは、前に説明した目的のために複雑なセットアップまたはインストールを必要としないシミュレーション環境で潜在的な新機能や概念などの特定のソフトウェア テクノロジ/製品の機能を提供します。このデモ/ラボで表されるテクノロジ/概念は、フル機能を表していない可能性があり、最終バージョンと動作が異なることがあります。また、そのような機能や概念の最終版がリリースされない場合があります。物理環境でこのような機能を使用するエクスペリエンスが異なる場合もあります。
フィードバック。このデモ/ラボで説明されているテクノロジ、機能、概念に関するフィードバックを Microsoft に提供する場合、ユーザーは任意の方法および目的でユーザーのフィードバックを使用、共有、および商品化する権利を無償で Microsoft に提供するものとします。また、ユーザーは、フィードバックを含む Microsoft のソフトウェアまたはサービスの特定部分を使用したり特定部分とインターフェイスを持ったりする製品、テクノロジ、サービスに必要な特許権を無償でサード パーティに付与します。ユーザーは、フィードバックを含めるために Microsoft がサード パーティにソフトウェアまたはドキュメントをライセンスする必要があるライセンスの対象となるフィードバックを提供しません。これらの権限は、本契約の後も存続します。
Microsoft Corporation は、明示、黙示、または法律上にかかわらず、商品性のすべての保証および条件、特定の目的、タイトル、非侵害に対する適合性など、デモ/ラボに関するすべての保証および条件を拒否します。Microsoft は、デモ/ラボから派生する結果、出力の正確さ、任意の目的に対するデモ/ラボに含まれる情報の適合性に関して、いかなる保証または表明もしません。
免責事項
このデモ/ラボには、Microsoft Power BI の新機能と機能強化の一部のみが含まれています。一部の機能は、製品の将来のリリースで変更される可能性があります。このデモ/ラボでは、新機能のすべてではなく一部について学習します。

